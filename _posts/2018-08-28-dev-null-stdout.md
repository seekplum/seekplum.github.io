---
layout: post
title: 理解 >/dev/null 2>&1 含义
categories: shell
tags: linux shell dev null stdout stderr
thread: shell
---
## 前言
在之前shell脚本中间经常看到`>/dev/null 2>&1`，一直只是理解为忽略shell执行错误，并把输出抛到黑洞中。基于想实现把执行信息追加到指定文件中且不输出到终端，一直出了些小问题，打算详细理解下`>/dev/null 2>&1`语法含义。

## shell重定向
就像我们平时写的程序一样，一段程序会处理外部的输入，然后将运算结果输出到指定的位置。在交互式的程序中，输入来自用户的键盘和鼠标，结果输出到用户的屏幕，甚至播放设备中。而对于某些后台运行的程序，输入可能来自于外部的一些文件，运算的结果通常又写到其他的文件中。而且程序在运行的过程中，会有一些关键性的信息，比如异常堆栈，外部接口调用情况等，这些都会统统写到日志文件里。

shell脚本也一样，但是我们一般在使用shell命令的时候，更多地还是通过键盘输入，然后在屏幕上查看命令的执行结果。如果某些情况下，我们需要将shell命令的执行结果存储到文件中，那么我们就需要使用输入输出的重定向功能。


## 文件描述符
当执行shell命令时，会默认打开3个文件，每个文件有对应的文件描述符来方便我们使用：

|类型|文件描述符|默认情况|对应文件句柄位置|
|:---|:---|:---|:---|
|标准输入(standard input)|0|从键盘获得输入|/proc/self/fd/0|
|标准输出(standard output)|1|输出到屏幕(即控制台)|/proc/self/fd/1|
|错误输出(error output)|2|输出到屏幕(即控制台)|/proc/self/fd/2|

所以我们平时在执行shell命令中，都默认是从键盘获得输入，并且将结果输出到控制台上。但是我们可以通过更改文件描述符默认的指向，从而实现输入输出的重定向。比如我们将1指向文件，那么标准的输出就会输出到文件中。

## 输出重定向

输出重定向的使用方式很简单，基本的一些命令如下：

|命令|介绍|
|:---|:---|
|command >filename|把标准输出重定向到新文件中|
|command 1>filename|把标准输出重定向到新文件中|
|command >>filename|把标准输出追加到文件中|
|command 1>>filename|把标准输出追加到文件中|
|command 2>filename|把标准错误重定向到新文件中|
|command 2>>filename|把标准错误追加到新文件中|

我们使用>或者>>对输出进行重定向。符号的左边表示文件描述符，如果没有的话表示1，也就是标准输出，符号的右边可以是一个文件，也可以是一个输出设备。当使用>时，会判断右边的文件存不存在，如果存在的话就先删除，然后创建一个新的文件，不存在的话则直接创建。但是当使用>>进行追加时，则不会删除原来已经存在的文件。

